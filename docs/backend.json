
{
  "entities": {
    "Membership": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Membership",
      "type": "object",
      "description": "Represents a casino member's profile and status.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the membership.",
          "format": "uuid"
        },
        "firstName": {
          "type": "string",
          "description": "The member's first name."
        },
        "lastName": {
          "type": "string",
          "description": "The member's last name."
        },
        "email": {
          "type": "string",
          "description": "The member's email address.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The member's phone number."
        },
        "enrollmentDate": {
          "type": "string",
          "description": "The date the member enrolled.",
          "format": "date-time"
        },
        "tierId": {
          "type": "string",
          "description": "Reference to Tier. (Relationship: Tier 1:N Membership)"
        },
        "pointsBalance": {
          "type": "number",
          "description": "The member's current points balance."
        },
        "status": {
          "type": "string",
          "description": "The current status of the member (e.g., 'Checked In', 'Checked Out').",
          "enum": ["Checked In", "Checked Out"]
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "enrollmentDate",
        "tierId",
        "pointsBalance"
      ]
    },
    "Tier": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tier",
      "type": "object",
      "description": "Represents a membership tier level.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tier.",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "description": "The name of the tier (e.g., 'Gold', 'Platinum')."
        },
        "description": {
          "type": "string",
          "description": "A description of the tier benefits."
        },
        "pointsThreshold": {
          "type": "number",
          "description": "The minimum points required to reach this tier."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "pointsThreshold"
      ]
    },
    "Reward": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Reward",
      "type": "object",
      "description": "Represents a reward that members can redeem.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the reward.",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "description": "The name of the reward (e.g., 'Free Buffet', 'Discounted Room')."
        },
        "description": {
          "type": "string",
          "description": "A description of the reward."
        },
        "pointsCost": {
          "type": "number",
          "description": "The points required to redeem this reward."
        },
        "category": {
            "type": "string",
            "description": "The category of the reward (e.g., 'Dining', 'Gaming')."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "pointsCost",
        "category"
      ]
    },
    "Redemption": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Redemption",
      "type": "object",
      "description": "Represents a member's redemption of a reward.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the redemption.",
          "format": "uuid"
        },
        "memberId": {
          "type": "string",
          "description": "Reference to Membership. (Relationship: Membership 1:N Redemption)"
        },
        "rewardId": {
          "type": "string",
          "description": "Reference to Reward. (Relationship: Reward 1:N Redemption)"
        },
        "redemptionDate": {
          "type": "string",
          "description": "The date the reward was redeemed.",
          "format": "date-time"
        },
        "rewardName": {
            "type": "string",
            "description": "The name of the redeemed reward."
        },
        "pointsCost": {
            "type": "number",
            "description": "The points cost of the redeemed reward."
        }
      },
      "required": [
        "id",
        "memberId",
        "rewardId",
        "redemptionDate",
        "rewardName",
        "pointsCost"
      ]
    },
    "VisitSummary": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "VisitSummary",
      "type": "object",
      "description": "Represents a summary of a member's visit, generated by the AI Patron Profiling Tool.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the visit summary.",
          "format": "uuid"
        },
        "memberId": {
          "type": "string",
          "description": "Reference to Membership. (Relationship: Membership 1:N VisitSummary)"
        },
        "visitDate": {
          "type": "string",
          "description": "The date of the visit.",
          "format": "date-time"
        },
        "summaryText": {
          "type": "string",
          "description": "The AI-generated summary of the visit."
        },
        "transactionIds": {
          "type": "array",
          "description": "References to Transactions. (Relationship: Transaction N:N VisitSummary)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "memberId",
        "visitDate",
        "summaryText"
      ]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a transaction made by a member.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the transaction.",
          "format": "uuid"
        },
        "memberId": {
          "type": "string",
          "description": "Reference to Membership. (Relationship: Membership 1:N Transaction)"
        },
        "transactionDate": {
          "type": "string",
          "description": "The date of the transaction.",
          "format": "date-time"
        },
        "amount": {
          "type": "number",
          "description": "The amount of the transaction."
        },
        "transactionType": {
          "type": "string",
          "description": "The type of transaction (e.g., 'Gaming', 'Dining', 'Hotel')."
        }
      },
      "required": [
        "id",
        "memberId",
        "transactionDate",
        "amount",
        "transactionType"
      ]
    },
    "CheckIn": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CheckIn",
      "type": "object",
      "description": "Represents a member's check-in/check-out record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the check-in record."
        },
        "memberId": {
          "type": "string",
          "description": "The ID of the member who is checking in/out."
        },
        "checkInTime": {
          "type": "string",
          "description": "The timestamp of when the member checked in.",
          "format": "date-time"
        },
        "checkOutTime": {
          "type": "string",
          "description": "The timestamp of when the member checked out.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "memberId",
        "checkInTime"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/memberships/{membershipId}",
        "definition": {
          "entityName": "Membership",
          "schema": {
            "$ref": "#/backend/entities/Membership"
          },
          "description": "Stores casino member profiles. Requires authentication to create or modify.  Uses path-based ownership for security.",
          "params": [
            {
              "name": "membershipId",
              "description": "The unique identifier of the membership."
            }
          ]
        }
      },
      {
        "path": "/tiers/{tierId}",
        "definition": {
          "entityName": "Tier",
          "schema": {
            "$ref": "#/backend/entities/Tier"
          },
          "description": "Stores membership tier information. Public read-only access.",
          "params": [
            {
              "name": "tierId",
              "description": "The unique identifier of the tier."
            }
          ]
        }
      },
      {
        "path": "/rewards/{rewardId}",
        "definition": {
          "entityName": "Reward",
          "schema": {
            "$ref": "#/backend/entities/Reward"
          },
          "description": "Stores reward information. Public read-only access.",
          "params": [
            {
              "name": "rewardId",
              "description": "The unique identifier of the reward."
            }
          ]
        }
      },
      {
        "path": "/memberships/{membershipId}/redemptions/{redemptionId}",
        "definition": {
          "entityName": "Redemption",
          "schema": {
            "$ref": "#/backend/entities/Redemption"
          },
          "description": "Stores reward redemption records for a specific member. Uses path-based ownership for security.",
          "params": [
            {
              "name": "membershipId",
              "description": "The unique identifier of the membership."
            },
            {
              "name": "redemptionId",
              "description": "The unique identifier of the redemption."
            }
          ]
        }
      },
      {
        "path": "/memberships/{membershipId}/visitSummaries/{visitSummaryId}",
        "definition": {
          "entityName": "VisitSummary",
          "schema": {
            "$ref": "#/backend/entities/VisitSummary"
          },
          "description": "Stores AI-generated visit summaries for a specific member. Uses path-based ownership for security.",
          "params": [
            {
              "name": "membershipId",
              "description": "The unique identifier of the membership."
            },
            {
              "name": "visitSummaryId",
              "description": "The unique identifier of the visit summary."
            }
          ]
        }
      },
      {
        "path": "/memberships/{membershipId}/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": {
            "$ref": "#/backend/entities/Transaction"
          },
          "description": "Stores transaction records for a specific member. Uses path-based ownership for security.",
          "params": [
            {
              "name": "membershipId",
              "description": "The unique identifier of the membership."
            },
            {
              "name": "transactionId",
              "description": "The unique identifier of the transaction."
            }
          ]
        }
      },
       {
        "path": "/memberships/{membershipId}/checkins/{checkinId}",
        "definition": {
          "entityName": "CheckIn",
          "schema": {
            "$ref": "#/backend/entities/CheckIn"
          },
          "description": "Stores check-in/check-out records for a specific member. Uses path-based ownership for security.",
          "params": [
            {
              "name": "membershipId",
              "description": "The unique identifier of the membership."
            },
            {
              "name": "checkinId",
              "description": "The unique identifier of the check-in record."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to manage casino membership data, tiers, rewards, redemptions, visit summaries, and transactions. The structure prioritizes Authorization Independence and supports the required QAPs by using structural segregation and the membership map pattern. Specifically, access to `memberships` collection is restricted, while access to `tiers` and `rewards` collection are public read-only. Redemptions, Visit Summaries, and Transactions are stored under each member's document. The memberships collection contains all the casino members. Denormalization is used to make security rules simple and robust. Path-based ownership is utilized for user-owned data."
  }
}

    