
{
  "entities": {
    "Company": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Company",
      "type": "object",
      "description": "Represents a company using the membership management system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the company."
        },
        "name": {
          "type": "string",
          "description": "The name of the company."
        },
        "logoUrl": {
          "type": "string",
          "description": "URL of the company's logo.",
          "format": "uri"
        }
      },
      "required": ["id", "name"]
    },
    "Membership": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Membership",
      "type": "object",
      "description": "Represents a casino member's profile and status.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique, numeric identifier for the membership."
        },
        "companyId": {
          "type": "string",
          "description": "The ID of the company this member belongs to."
        },
        "firstName": {
          "type": "string",
          "description": "The member's first name."
        },
        "lastName": {
          "type": "string",
          "description": "The member's last name."
        },
        "email": {
          "type": "string",
          "description": "The member's email address.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The member's phone number."
        },
        "enrollmentDate": {
          "type": "string",
          "description": "The date the member enrolled.",
          "format": "date-time"
        },
        "tierId": {
          "type": "string",
          "description": "Reference to Tier. (Relationship: Tier 1:N Membership)"
        },
        "pointsBalance": {
          "type": "number",
          "description": "The member's current points balance."
        },
        "status": {
          "type": "string",
          "description": "The current status of the member (e.g., 'Checked In', 'Checked Out').",
          "enum": ["Checked In", "Checked Out"]
        }
      },
      "required": [
        "id",
        "companyId",
        "firstName",
        "lastName",
        "email",
        "enrollmentDate",
        "tierId",
        "pointsBalance"
      ]
    },
    "Tier": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tier",
      "type": "object",
      "description": "Represents a membership tier level.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tier.",
          "format": "uuid"
        },
        "companyId": {
          "type": "string",
          "description": "The ID of the company this tier belongs to."
        },
        "name": {
          "type": "string",
          "description": "The name of the tier (e.g., 'Gold', 'Platinum')."
        },
        "description": {
          "type": "string",
          "description": "A description of the tier benefits."
        },
        "pointsThreshold": {
          "type": "number",
          "description": "The minimum points required to reach this tier."
        }
      },
      "required": [
        "id",
        "companyId",
        "name",
        "description",
        "pointsThreshold"
      ]
    },
    "Reward": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Reward",
      "type": "object",
      "description": "Represents a reward that members can redeem.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the reward.",
          "format": "uuid"
        },
        "companyId": {
          "type": "string",
          "description": "The ID of the company this reward belongs to."
        },
        "name": {
          "type": "string",
          "description": "The name of the reward (e.g., 'Free Buffet', 'Discounted Room')."
        },
        "description": {
          "type": "string",
          "description": "A description of the reward."
        },
        "pointsCost": {
          "type": "number",
          "description": "The points required to redeem this reward."
        },
        "category": {
            "type": "string",
            "description": "The category of the reward (e.g., 'Dining', 'Gaming')."
        }
      },
      "required": [
        "id",
        "companyId",
        "name",
        "description",
        "pointsCost",
        "category"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/companies/{companyId}",
        "definition": {
          "entityName": "Company",
          "schema": { "$ref": "#/backend/entities/Company" },
          "description": "Stores company profiles for multi-tenancy."
        }
      },
      {
        "path": "/companies/{companyId}/memberships/{membershipId}",
        "definition": {
          "entityName": "Membership",
          "schema": { "$ref": "#/backend/entities/Membership" },
          "description": "Stores casino member profiles, scoped by company."
        }
      },
      {
        "path": "/companies/{companyId}/tiers/{tierId}",
        "definition": {
          "entityName": "Tier",
          "schema": { "$ref": "#/backend/entities/Tier" },
          "description": "Stores membership tier information, scoped by company."
        }
      },
      {
        "path": "/companies/{companyId}/rewards/{rewardId}",
        "definition": {
          "entityName": "Reward",
          "schema": { "$ref": "#/backend/entities/Reward" },
          "description": "Stores reward information, scoped by company."
        }
      },
      {
        "path": "/companies/{companyId}/memberships/{membershipId}/redemptions/{redemptionId}",
        "definition": {
          "entityName": "Redemption",
          "schema": { "$ref": "#/backend/entities/Redemption" },
          "description": "Stores reward redemption records, scoped by company and member."
        }
      },
      {
        "path": "/companies/{companyId}/memberships/{membershipId}/checkins/{checkinId}",
        "definition": {
          "entityName": "CheckIn",
          "schema": { "$ref": "#/backend/entities/CheckIn" },
          "description": "Stores check-in records, scoped by company and member."
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed for multi-tenancy. All primary data collections (memberships, tiers, rewards) are subcollections of a top-level 'companies' collection. This ensures strict data segregation between different companies. Security rules will leverage the `companyId` in the path to grant access only to users associated with that specific company via custom claims."
  }
}
